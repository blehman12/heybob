<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      
      <!-- Success Message -->
      <div class="card shadow-sm border-success">
        <div class="card-body text-center py-5">
          <div class="mb-4">
            <i class="bi bi-check-circle-fill text-success" style="font-size: 5rem;"></i>
          </div>
          
          <h1 class="display-4 mb-3">Thank You!</h1>
          <p class="lead mb-4">Your RSVP has been successfully submitted.</p>
          
          <!-- Event Summary -->
          <div class="card bg-light mb-4">
            <div class="card-body">
              <h4 class="mb-3"><%= @event.name %></h4>
              <p class="mb-2">
                <i class="bi bi-calendar-event text-primary"></i>
                <strong>Date:</strong> <%= @event.event_date.strftime('%A, %B %d, %Y') %>
              </p>
              <% if @event.start_time.present? %>
                <p class="mb-2">
                  <i class="bi bi-clock text-primary"></i>
                  <strong>Time:</strong> <%= @event.start_time.strftime('%I:%M %p') %>
                </p>
              <% end %>
              <% if @event.venue.present? %>
                <p class="mb-0">
                  <i class="bi bi-geo-alt text-primary"></i>
                  <strong>Location:</strong> <%= @event.venue.name %>
                </p>
              <% end %>
            </div>
          </div>

          <!-- RSVP Details -->
          <div class="alert alert-info">
            <% if @event_participant.is_guest? %>
              <p class="mb-2"><strong>Name:</strong> <%= @event_participant.guest_name %></p>
              <% if @event_participant.guest_email.present? %>
                <p class="mb-2"><strong>Email:</strong> <%= @event_participant.guest_email %></p>
                <p class="mb-0 small">We'll send event updates to this email address.</p>
              <% end %>
            <% else %>
              <p class="mb-0">Confirmation sent to <%= @event_participant.user.email %></p>
            <% end %>
          </div>

          <!-- RSVP Status -->
          <div class="mb-4">
            <h5>Your Response:</h5>
            <span class="badge bg-<%= @event_participant.rsvp_status == 'yes' ? 'success' : (@event_participant.rsvp_status == 'maybe' ? 'warning' : 'secondary') %> fs-5 px-4 py-2">
              <%= @event_participant.rsvp_status_text %>
            </span>
          </div>

          <!-- Add to Calendar -->
          <% if @event_participant.rsvp_status == 'yes' %>
            <div class="mb-4">
              <%= link_to public_event_calendar_path(@event.slug), class: 'btn btn-success btn-lg' do %>
                <i class="bi bi-calendar-plus"></i> Add to Calendar
              <% end %>
              <p class="text-muted small mt-2">Download .ics file for Google Calendar, Apple Calendar, Outlook</p>
            </div>
          <% end %>

          <!-- Next Steps -->
          <div class="mt-4">
            <h5 class="mb-3">What's Next?</h5>
            <div class="d-grid gap-2 d-md-flex justify-content-md-center">
              <%= link_to public_event_path(@event.slug), class: 'btn btn-outline-primary' do %>
                <i class="bi bi-arrow-left"></i> Back to Event Details
              <% end %>
              <% if @event.rsvp_open? %>
                <%= link_to public_event_path(@event.slug), class: 'btn btn-outline-secondary' do %>
                  <i class="bi bi-pencil"></i> Update My RSVP
                <% end %>
              <% end %>
            </div>
          </div>
        </div>
      </div>

      <!-- Share Event -->
      <div class="card shadow-sm mt-4">
        <div class="card-body text-center">
          <h5 class="mb-3">Spread the Word!</h5>
          <p class="text-muted mb-3">Share this event with friends:</p>
          
          <div class="input-group mb-3">
            <input type="text" class="form-control" id="shareUrl" value="<%= request.base_url %><%= public_event_path(@event.slug) %>" readonly>
            <button class="btn btn-outline-secondary" type="button" onclick="copyShareUrl()">
              <i class="bi bi-clipboard"></i> Copy Link
            </button>
          </div>
          
          <div class="d-flex gap-2 justify-content-center flex-wrap">
            <a href="https://www.facebook.com/sharer/sharer.php?u=<%= CGI.escape(request.base_url + public_event_path(@event.slug)) %>" 
               target="_blank" class="btn btn-sm btn-primary">
              <i class="bi bi-facebook"></i> Facebook
            </a>
            <a href="https://twitter.com/intent/tweet?url=<%= CGI.escape(request.base_url + public_event_path(@event.slug)) %>&text=<%= CGI.escape("Join me at #{@event.name}!") %>" 
               target="_blank" class="btn btn-sm btn-info text-white">
              <i class="bi bi-twitter"></i> Twitter
            </a>
            <a href="mailto:?subject=<%= CGI.escape("You're invited: #{@event.name}") %>&body=<%= CGI.escape("I wanted to invite you to #{@event.name}!\n\nRSVP here: #{request.base_url + public_event_path(@event.slug)}") %>" 
               class="btn btn-sm btn-secondary">
              <i class="bi bi-envelope"></i> Email
            </a>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
function copyShareUrl() {
  const urlInput = document.getElementById('shareUrl');
  urlInput.select();
  urlInput.setSelectionRange(0, 99999); // For mobile devices
  
  navigator.clipboard.writeText(urlInput.value).then(() => {
    // Change button text temporarily
    const btn = event.target.closest('button');
    const originalHTML = btn.innerHTML;
    btn.innerHTML = '<i class="bi bi-check"></i> Copied!';
    btn.classList.remove('btn-outline-secondary');
    btn.classList.add('btn-success');
    
    setTimeout(() => {
      btn.innerHTML = originalHTML;
      btn.classList.remove('btn-success');
      btn.classList.add('btn-outline-secondary');
    }, 2000);
  }).catch(err => {
    console.error('Failed to copy:', err);
    alert('Failed to copy link. Please copy manually.');
  });
}
</script>
